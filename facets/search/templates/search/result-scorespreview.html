{% load i18n %}

<!--/////////////-->
<!-- VEROVIO -->
<!--/////////////-->  


<script src="/static/js/verovio-toolkit.js"></script>
<script>var vrvToolkit = new verovio.toolkit();</script>

<div>
    <ul class="toolbar">
    {% if score_info %}

    {% for i in score_info %}


        {% if score_info.i == "mei" %}
        <li class="mei"><a target="_blank" href="{{score_url.i}}"
                           title="{% trans 'Download MEI' %}"> <span class="accessibility">{% trans 'Download MEI' %}</span>
        </a></li>
        {% endif  %}

        {% if score_info.i == "musicxml" or score_info.i == "xml" %}
        <li class="download"><a target="_blank" href="{{score_url.i}}"
                                title="{% trans 'Download MusicXML'%}" target="_blank"> <span class="accessibility">{% trans 'Download MusicXML' %}</span>
        </a></li>
        {% endif %}
 
    </ul>
        <a name="{{i}}" />
        <h5>
            link here
            <a href="{{i}} ">{{i}}</a>
        </h5>
    
        <script type="text/javascript">
        /* Load the file using HTTP GET */
        console.log ("Get {{score_url.i}}")
            var vrvOptions = {
            scale : 35,
            pageHeight : 100,
            adjustPageHeight : 1,
            border : 0,
            ignoreLayout : 1
        };

        vrvToolkit.setOptions(vrvOptions);
        document.addEventListener('DOMContentLoaded', (event) => {
            $.ajax({
                url: "{{score_url.i}}",
                dataType: "text",
                success: function(data) {
                    var svg = vrvToolkit.renderData(data);
                    document.getElementById("notation").innerHTML = svg;
                    //$("#incipit{{i}}").html(svg);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log("Error with document {{i}} " + xhr.status);
                }
            });
        });
        </script>       

        <table class="preview"><tr>
            <td valign="top">
            </td><td>     <a href="home/dashboard/{{searchinput.index_name}}/{{i}}'";><div id="incipit{{i}}"></div></a>
        </td>
        </tr>
        </table>

    {% endfor %}

    {% else %}
    <table class="preview"><tr>
        <td valign="top"> </td>
        <td>     <div id="notation">scores placeholder</div> </td>
    </tr>
    </table>
    {% endif %}

</div>

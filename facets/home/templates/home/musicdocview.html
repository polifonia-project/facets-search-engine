{% extends 'base.html'%}

{% block content %}
{% include 'navbar.html' %}


<div class="container">
    <div class="row mb-12">


        <div class="col-lg-10 mx-auto">
            <h1 class="text-center">{{ globalvariables.sitename }} MusicDoc View</h1>

            <div class="card text-center">
                <div class="card-header">
                    {% comment %}URL of the score is <a href="{{ doc_url }}">URL</a>
                    {% endcomment %}
                    <ul>
                        <li>Document ID: {{ doc_id }} </li>
                        {% comment %}
                        { % if doc_title %}
                        <li> Title: {{ doc_title }} </li>
                        {% endif %}
                        {% if doc_composer %}
                        <li> Composer: {{ doc_composer }} </li>
                        {% endif %}
                        <li>docurl: {{ doc_url }} </li>
                        {% endcomment %}
                        <li>Score format: {{ doc_type }} </li>
                    </ul>
                </div>
    
                {% if doc_url %}
                <script type="text/javascript">
                /* Load the file using HTTP GET */
                console.log ("Obtained {{doc_url}}");
                document.addEventListener('DOMContentLoaded', (event) => {
                    $.ajax({
                        url: "{{doc_url}}", 
                        dataType: "text", 
                        success: function(data) {
                            let svg = vrvToolkit.renderData(data);
                            document.getElementById("notation").innerHTML = svg;
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            console.log("Error with document {{doc_url}} " + xhr.status);
                        }
                    });
                });
                </script>       

                <table class="preview"><tr>
                    <td valign="top"> </td>
                    <td>     <div id="notation">
                    score placeholder
                    </div> </td>
                </tr>
                </table>
                
        {%if doc_type == 'krn'%}
        <div>
        The support of visualization of Humdrum files is coming soon...
        </div>
        {%endif%}
                {% else %}
                no score to display
                {% endif %}
            </div>
        </div>


    </div> <!-- row -->
</div> <!-- container -->

{% endblock %}
